<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cameo Opaque Expression Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé® Cameo Opaque Expression Generator</h1>
            <p class="subtitle">Describe what you want to achieve, and we'll show you how to create the corresponding opaque expression in Cameo</p>
        </header>

        <main>
            <div class="api-key-section">
                <div class="api-key-wrapper">
                    <label for="apiKeyInput">üîë Mistral.AI API Key (optional - leave blank to use without API)</label>
                    <input 
                        type="password" 
                        id="apiKeyInput" 
                        placeholder="Enter your Mistral.AI API key (stored locally in browser)"
                        class="api-key-input"
                    />
                    <small class="api-key-help">Your API key is stored locally in your browser and never sent to our servers. Get your key from <a href="https://console.mistral.ai/" target="_blank">console.mistral.ai</a></small>
                </div>
            </div>

            <div class="context-section">
                <div class="context-wrapper">
                    <label for="contextSelect">Expression Context</label>
                    <select id="contextSelect" class="context-select">
                        <option value="">Select where this expression will be used...</option>
                        <option value="scope-criteria">Scope Criteria</option>
                        <option value="derived-property">Derived Property</option>
                        <option value="custom-column">Custom Column</option>
                        <option value="legend">Legend</option>
                    </select>
                    <small class="context-help">Select the Cameo context where you'll use this expression</small>
                </div>
                
                <!-- Scope Criteria: Package or Element -->
                <div id="scopeCriteriaOptions" class="context-options" style="display: none;">
                    <div class="context-option-wrapper">
                        <label for="scopeInputType">Input Type</label>
                        <select id="scopeInputType" class="context-select">
                            <option value="">Select input type...</option>
                            <option value="package">Package</option>
                            <option value="element">Element</option>
                        </select>
                        <small class="context-help">Is the input a package or an element?</small>
                    </div>
                </div>
                
                <!-- Custom Column: Row Type -->
                <div id="customColumnOptions" class="context-options" style="display: none;">
                    <div class="context-option-wrapper">
                        <label for="rowType">Row Type</label>
                        <select id="rowType" class="context-select">
                            <option value="">Select row type...</option>
                            <optgroup label="SysML Types">
                                <option value="Block">Block</option>
                                <option value="Part">Part</option>
                                <option value="ValueType">ValueType</option>
                                <option value="InterfaceBlock">InterfaceBlock</option>
                                <option value="Port">Port</option>
                                <option value="FlowPort">FlowPort</option>
                                <option value="Action">Action</option>
                                <option value="Activity">Activity</option>
                                <option value="StateMachine">StateMachine</option>
                                <option value="State">State</option>
                                <option value="Transition">Transition</option>
                                <option value="Requirement">Requirement</option>
                                <option value="ConstraintBlock">ConstraintBlock</option>
                                <option value="Property">Property</option>
                                <option value="Operation">Operation</option>
                                <option value="Parameter">Parameter</option>
                                <option value="Class">Class</option>
                                <option value="Association">Association</option>
                                <option value="Dependency">Dependency</option>
                                <option value="Generalization">Generalization</option>
                            </optgroup>
                            <optgroup label="Custom Types">
                                <option value="[CUSTOM TYPE]">Custom Type (enter in prompt)</option>
                            </optgroup>
                        </select>
                        <small class="context-help">Select the SysML type or custom type for the row</small>
                    </div>
                </div>
                
                <!-- Derived Property: Element Type -->
                <div id="derivedPropertyOptions" class="context-options" style="display: none;">
                    <div class="context-option-wrapper">
                        <label for="elementType">Element Type</label>
                        <select id="elementType" class="context-select">
                            <option value="">Select element type...</option>
                            <optgroup label="SysML Types">
                                <option value="Block">Block</option>
                                <option value="Part">Part</option>
                                <option value="ValueType">ValueType</option>
                                <option value="InterfaceBlock">InterfaceBlock</option>
                                <option value="Port">Port</option>
                                <option value="FlowPort">FlowPort</option>
                                <option value="Action">Action</option>
                                <option value="Activity">Activity</option>
                                <option value="StateMachine">StateMachine</option>
                                <option value="State">State</option>
                                <option value="Transition">Transition</option>
                                <option value="Requirement">Requirement</option>
                                <option value="ConstraintBlock">ConstraintBlock</option>
                                <option value="Property">Property</option>
                                <option value="Operation">Operation</option>
                                <option value="Parameter">Parameter</option>
                                <option value="Class">Class</option>
                                <option value="Association">Association</option>
                                <option value="Dependency">Dependency</option>
                                <option value="Generalization">Generalization</option>
                            </optgroup>
                            <optgroup label="Custom Types">
                                <option value="[CUSTOM TYPE]">Custom Type (enter in prompt)</option>
                            </optgroup>
                        </select>
                        <small class="context-help">Select the SysML type or custom type for the element</small>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-wrapper">
                    <textarea 
                        id="promptInput" 
                        placeholder="Enter your natural language prompt here...&#10;&#10;Example: 'Find all classes that have a property named status'&#10;Example: 'Get all operations from classes that extend a specific base class'"
                        rows="6"
                    ></textarea>
                    <button id="submitBtn" class="submit-btn">
                        <span class="btn-text">Generate Expression</span>
                        <span class="btn-loader" style="display: none;">‚è≥ Generating...</span>
                    </button>
                </div>
            </div>

            <div id="responseSection" class="response-section" style="display: none;">
                <div class="response-header">
                    <h2>Generated Opaque Expression Guide</h2>
                </div>
                
                <div id="userPromptSection" class="user-prompt-section" style="display: none;">
                    <h3>üí¨ Your Prompt</h3>
                    <p id="userPromptContent"></p>
                </div>
                
                <div id="structuredContent" class="structured-content">
                    <div id="intentSection" class="section-block" style="display: none;">
                        <h3>üéØ Intent</h3>
                        <p id="intentContent"></p>
                    </div>
                    
                    <div id="startingContextSection" class="section-block" style="display: none;">
                        <h3>üìç Starting Context</h3>
                        <p id="startingContextContent"></p>
                    </div>
                    
                    <div id="metachainSection" class="section-block" style="display: none;">
                        <h3>üîó Metachain</h3>
                        <code id="metachainContent" class="code-block"></code>
                    </div>
                    
                    <div id="filtersSection" class="section-block" style="display: none;">
                        <h3>üîç Filters</h3>
                        <p id="filtersContent"></p>
                    </div>
                    
                    <div id="finalExpressionSection" class="section-block" style="display: none;">
                        <h3>üìù Final Expression Template</h3>
                        <pre id="finalExpressionContent" class="code-block"></pre>
                    </div>
                    
                    <div id="notesSection" class="section-block" style="display: none;">
                        <h3>üí° Notes</h3>
                        <p id="notesContent"></p>
                    </div>
                </div>
                
                <div id="expressionViewSection" class="expression-view-section" style="display: none;">
                    <h3>üå≥ Expression View</h3>
                    <div id="expressionViewTree" class="expression-tree"></div>
                </div>
                
                <div id="rawResponseSection" class="raw-response-section" style="display: none;">
                    <details>
                        <summary>üìÑ Raw Response</summary>
                        <pre id="rawResponseContent" class="code-block"></pre>
                    </details>
                </div>
            </div>

            <div id="errorSection" class="error-section" style="display: none;">
                <div class="error-content">
                    <span class="error-icon">‚ö†Ô∏è</span>
                    <span id="errorMessage"></span>
                </div>
            </div>
        </main>

        <footer>
            <p>Based on <a href="https://docs.nomagic.com/spaces/MD2021x/pages/64978604/Creating+new+operations" target="_blank">Cameo Documentation</a></p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>

